<div class="modal fade right" id="add_followup_detail" tabindex="-1" role="dialog" aria-labelledby="sample_approval">
  <div class="modal-dialog modal-full-height modal-right half-right-3" role="document">
    <div class="modal-content">
      <div class="modal-header close_popup">
        <h4 class="modal-title w-100 c-grey-900">
          Add {{ formtype ? "Follow Up " : "Lead" }} Details
        </h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close" (click)="closePopUp()">
          <span aria-hidden="true">Ã—</span>
        </button>
      </div>
      <form #addLeadDetailForm="ngForm" novalidate (ngSubmit)="addLeadDetailForm.form.valid && submit()">
        <div class="modal-body">
          <div class="row">
            <div class="col-lg-4 bdR">
              <div class="tab_vertical">
                <ul class="nav tabs-cyan flex-column" role="tablist">
                  <li class="nav-item">
                    <a class="nav-link waves-light" data-toggle="tab" href="#panel539" role="tab">Company
                      Information</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link waves-light active" data-toggle="tab" href="#panel519" role="tab">Personal
                      Detail</a>
                  </li>
                </ul>
              </div>
            </div>
            <div class="col-lg-8">
              <div class="tab-content">
                <div class="tab-pane fade " id="panel539" role="tabpanel">
                  <div class="form-row">
                    <div class="card-header">
                      Company Information
                    </div>
                    <div class="card-body">
                      <div class="form-row">
                        <div class="form-group col-md-6">
                          <label>Comapany Name</label>
                          <input type="text" class="form-control" placeholder="Enter Value" name="companyName"
                            [disabled]="true" [(ngModel)]="model.companyName" />
                        </div>
                        <div class="form-group col-md-6">
                          <label>Number of Employees</label>
                          <ng-select name="noOfEmployeeName" [items]="noOfEmployeeList" bindLabel="Name" bindValue="Id"
                            placeholder="Select No Of Employees" [(ngModel)]="model.selectedNoOfEmployeeId">
                          </ng-select>
                        </div>
                        <div class="form-group col-md-6">
                          <label>Company Annual Revenue</label>
                          <input type="text" class="form-control" placeholder="Enter Value" name="revenue"
                            [(ngModel)]="model.companyRevenue" />
                        </div>
                        <div class="form-group col-md-6">
                          <label>Company Website</label>
                          <input type="text" class="form-control" placeholder="Enter Value" name="companyWebsite"
                            [(ngModel)]="model.companyWebsite" />
                        </div>
                        <div class="form-group col-md-6 col-12">
                          <label>Business Type</label>
                          <ng-select name="businessTypeName" disabled="true"
                            [items]="crmService.leadUtilityData.BusinessType" bindLabel="commondesc" bindValue="id"
                            placeholder="Select Business Type" [(ngModel)]="model.selectedBusinessTypeId" (change)="
                              onChangeSelection(
                                'Business Type',
                                'selectedBusinessTypeId',
                                193
                              )
                            ">
                          </ng-select>
                        </div>
                        <div class="form-group col-md-6 col-12">
                          <label>Industory Type</label>
                          <ng-select name="industryTypeName" [items]="crmService.leadUtilityData.IndustryType"
                            bindLabel="commondesc" bindValue="id" placeholder="Select Industry Type"
                            [(ngModel)]="model.selectedIndustryTypeId" (change)="
                              onChangeSelection(
                                'Industry Type',
                                'selectedIndustryTypeId',
                                125
                              )
                            ">
                          </ng-select>
                        </div>
                      </div>
                      <div class="form-row">
                        <div class="form-group col-md-6">
                          <label>Country</label>
                          <ng-select name="countryName" [items]="countryList" bindLabel="CommonDesc" bindValue="Id"
                            placeholder="Select Country" [(ngModel)]="countryId" (change)="getStateList(countryId)">
                          </ng-select>
                        </div>
                        <div class="form-group col-md-6">
                          <label>State</label>
                          <ng-select name="stateName" [items]="stateList" bindLabel="CommonDesc1" bindValue="Id"
                            placeholder="Select State" [(ngModel)]="stateId" (change)="getCityList(stateId)">
                          </ng-select>
                        </div>
                        <div class="form-group col-md-6">
                          <label>City</label>
                          <ng-select name="cityName" [items]="cityList" bindLabel="CommonDesc2" bindValue="Id"
                            placeholder="Select City" [(ngModel)]="cityId" (change)="getAreaList(cityId)">
                          </ng-select>
                        </div>
                        <div class="form-group col-md-6">
                          <label>Area</label>
                          <ng-select name="areaName" [items]="areaList" bindLabel="CommonDesc3" bindValue="Id"
                            placeholder="Select Area" [(ngModel)]="areaId">
                          </ng-select>
                        </div>
                        <div class="form-group col-md-6">
                          <label>Address Type</label>
                          <ng-select name="addressTypeName" [items]="addressTypeList" bindLabel="CommonDesc"
                            bindValue="UId" placeholder="Select Address Type" [(ngModel)]="addressTypeId">
                          </ng-select>
                        </div>
                        <div class="form-group col-md-6">
                          <label>Address</label>
                          <textarea name="addressName" cols="30" rows="2" [(ngModel)]="address" class="form-control"
                            placeholder="Enter Address">
                          </textarea>
                        </div>
                      </div>
                      <div class="form-group col-md-12 pl-0 pr-0">
                        <div class="card p-2" style="width: 100%;">
                          <h5 class="summery_text">
                            Email -
                            <span>
                              <a href="javascript:void(0)" (click)="addEmail('companyEmailList')">Add Email</a>
                            </span>
                          </h5>
                          <table class="table editable_tbl" style="width: 100%">
                            <thead>
                              <th>Email Type</th>
                              <th>Email Id</th>
                              <th>#</th>
                            </thead>
                            <tbody>
                              <tr class="default_row" *ngFor="
                                  let item of model?.companyEmailList;
                                  let i = index
                                ">
                                <td>{{ item?.emailTypeName }}</td>
                                <td>{{ item?.email }}</td>
                                <td class="profile-pic1">
                                  <div>
                                    <a href="javascript:void(0)" class="p-2" (click)="
                                        addEmail('companyEmailList', item, i)
                                      "><i class="fas fa-pen fa-1x cH-blue"></i>
                                    </a>
                                    <a href="javascript:void(0)" (click)="
                                        deleteEmail('companyEmailList', i)
                                      ">
                                      <i aria-hidden="true" class="fa fa-trash fa-1x cH-blue"></i>
                                    </a>
                                  </div>
                                </td>
                              </tr>
                            </tbody>
                          </table>
                        </div>
                      </div>
                      <div class="form-group col-md-12 pl-0 pr-0">
                        <div class="card p-2" style="width: 100%;">
                          <h5 class="summery_text">
                            Mobile No -
                            <span>
                              <a href="javascript:void(0)" (click)="addMobileNo('companyMobileNoList')">Add Mobile
                                No</a>
                            </span>
                          </h5>
                          <table class="table editable_tbl" style="width: 100%">
                            <tbody>
                              <tr class="default_row" *ngFor="
                                  let item of model?.companyMobileNoList;
                                  let i = index
                                ">
                                <td>{{ item?.displayLabel }}</td>
                                <td class="profile-pic1">
                                  <div>
                                    <a href="javascript:void(0)" class="p-2" (click)="
                                        addMobileNo(
                                          'companyMobileNoList',
                                          item,
                                          i
                                        )
                                      "><i class="fas fa-pen fa-1x cH-blue"></i>
                                    </a>
                                    <a href="javascript:void(0)" (click)="
                                        deleteMobileNo('companyMobileNoList', i)
                                      ">
                                      <i aria-hidden="true" class="fa fa-trash fa-1x cH-blue"></i>
                                    </a>
                                  </div>
                                </td>
                              </tr>
                            </tbody>
                          </table>
                        </div>
                      </div>
                      <div class="form-row">
                        <div class="card-header">
                          Social Profile
                        </div>
                        <div class="card-body">
                          <table class="table editable_tbl" style="width: 100%">
                            <thead>
                              <tr>
                                <th>Social Media</th>
                                <th>Url</th>
                                <th>#</th>
                              </tr>
                            </thead>
                            <tbody>
                              <ng-container *ngFor="
                                  let item of model?.socialProfileList;
                                  let i = index
                                ">
                                <tr class="default_row">
                                  <td>{{ item?.name }}</td>
                                  <td>{{ item?.url }}</td>
                                  <td class="profile-pic1">
                                    <div>
                                      <a class="p-2" href="javascript:void(0)" (click)="editSocialProfile(item, i)"><i
                                          class="fas fa-pen fa-1x cH-blue"></i>
                                      </a>
                                      <a href="javascript:void(0)" (click)="deleteSocialProfile(i)">
                                        <i aria-hidden="true" class="fa fa-trash fa-1x cH-blue"></i>
                                      </a>
                                    </div>
                                  </td>
                                </tr>
                              </ng-container>
                              <tr class="selected_row">
                                <td>
                                  <ng-select name="socialMediaName" [items]="socialMediaList" bindLabel="CommonDesc"
                                    bindValue="UId" placeholder="Select Social Media"
                                    [(ngModel)]="selectedSocialMediaId">
                                  </ng-select>
                                </td>
                                <td>
                                  <input type="text" class="form-control" name="url" [(ngModel)]="socialMediaUrl" />
                                </td>
                                <td>
                                  <button type="button" id="btn_add" (click)="addSocialProfile()"
                                    class="btn btn-primary btn_add_more waves-effect waves-light">
                                    +
                                  </button>
                                </td>
                              </tr>
                            </tbody>
                          </table>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="tab-pane fade in show active" id="panel519" role="tabpanel">
                  <div class="form-row">
                    <div class="card-header">
                      Personal Information
                    </div>
                    <div class="card-body">
                      <div class="form-row">
                        <div class="form-group col-md-12 pl-0 pr-0">
                          <div class="card p-2" style="width: 100%;">
                            <form #keyPersonForm="ngForm" novalidate (ngSubmit)="keyPersonForm.form.valid && addKeyPerson()">
                                <div class="form-row d-flex align-items-center">
                                    <div class="form-group col-md-6 col-12">
                                      <label>Name</label>
                                      <input type="text" class="form-control"
                                       placeholder="Enter First Name"
                                       name="firstName"
                                        [(ngModel)]="model.firstName"
                                        (change)="model.firstName =  commonService.convertToTitleCase(model.firstName)"
                                        required
                                        [ngClass]="{'errorSelecto': keyPersonForm.submitted && !model.firstName}"/>
                                    </div>
                                    <div class="form-group col-md-6 col-12">
                                      <label>Designation</label>
                                      <ng-select
                                       name="designationName"
                                       [items]="crmService.leadUtilityData.MeetingWith" bindLabel="commondesc"
                                        bindValue="id" placeholder="Select Designation"
                                        [(ngModel)]="model.selectedDesignationId"
                                        required
                                        [ngClass]="{'ng-select-invalid': keyPersonForm.submitted && !model.selectedDesignationId}">
                                      </ng-select>
                                    </div>
                                    <div class="form-group col-md-6 col-12">
                                      <label>Departments</label>
                                      <input type="text" class="form-control" placeholder="Enter Department" name="department"
                                        [(ngModel)]="model.department"
                                        required
                                        [ngClass]="{'errorSelecto': keyPersonForm.submitted && !model.department}"/>
                                    </div>
                                    <div class="form-group col-md-6 col-12">
                                        <label>Country Code</label>
                                        <ng-select
                                          name="countryCodeName"
                                          [items]="mobileCountryCodeList"
                                          bindLabel="text"
                                          bindValue="id"
                                          placeholder="Select Country Code"
                                          [(ngModel)]="model.countryCodeId"
                                          (change)="setCurrentMobileNoLength()"
                                        >
                                        </ng-select>
                                      </div>
                                      <div class="form-group col-md-6 col-12">
                                        <label>Mobile No</label>
                                        <input
                                          type="text"
                                          id="mobileId"
                                          class="form-control"
                                          #mobileNoModel="ngModel"
                                          placeholder="Enter Mobile No"
                                          (keypress)="commonService.isNumber($event, true, model.mobileNo)"
                                          [disabled]="!model.countryCodeId"
                                          maxlength="{{ currentContactLength }}"
                                          minlength="{{ currentContactLength }}"
                                          name="mobileNoName"
                                          [(ngModel)]="model.mobileNo"
                                          [ngClass]="{
                                            errorSelecto:
                                              (mobileNoModel?.dirty &&
                                                mobileNoModel?.errors?.maxlength) ||
                                              (mobileNoModel?.dirty &&
                                                mobileNoModel?.errors?.minlength) ||
                                              (keyPersonForm.submitted && mobileNoModel?.invalid)
                                          }"
                                        />
                                      </div>
                                      <div class="form-group col-md-6 col-12">
                                          <label>Email Type</label>
                                          <ng-select
                                            name="typeName"
                                            [items]="emailTypeList"
                                            bindLabel="text"
                                            bindValue="id"
                                            placeholder="Select Type"
                                            [(ngModel)]="model.emailType"
                                            [ngClass]="{'ng-select-invalid': keyPersonForm?.submitted && !model.emailType}"
                                          >
                                          </ng-select>
                                        </div>
                                      <div class="form-group col-md-6 col-12">
                                          <label>Email</label>
                                          <input
                                            type="text"
                                            class="form-control"
                                            #emailModel="ngModel"
                                            placeholder="Enter Email"
                                            name="emailName"
                                            [(ngModel)]="model.email"
                                            pattern="^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$"
                                            [ngClass]="{
                                              errorSelecto:
                                                (emailModel.dirty && emailModel?.errors?.pattern) ||
                                                (keyPersonForm.submitted && emailModel?.invalid)
                                            }"
                                          />
                                        </div>
                                    <div class="form-group col-md-2 mt-4">
                                        <button type="submit" class="btn btn-primary">
                                            Submit
                                          </button>
                                    </div>
                                  </div>
                            </form>
                            <table class="table editable_tbl" style="width: 100%" *ngIf="model?.contactPersonList?.length > 0">
                                <thead>
                                    <th>Name</th>
                                    <th>Designation</th>
                                    <th>Mobile No</th>
                                    <th>#</th>
                                  </thead>
                              <tbody>
                                <tr class="default_row" *ngFor="
                                    let item of model.contactPersonList;
                                    let i = index;
                                  ">
                                  <td>
                                      <div class="custom-control custom-radio custom-control-inline">
                                          <input type="radio"
                                           id="keyPersonRadio-{{i}}"
                                          name="keyPersonRadioName"
                                          [checked]="i === model.defaultCheckedIndex"
                                          (change)="onChangeKeyPersonSelection($event, i)"
                                          class="custom-control-input">
                                          <label class="custom-control-label"
                                           for="keyPersonRadio-{{i}}">{{ item?.name }}</label>
                                        </div>
                                    </td>
                                  <td>{{ item?.designationName }}</td>
                                  <td>{{ item.mobileNo }}</td>
                                  <td class="profile-pic1">
                                    <div>
                                      <a href="javascript:void(0)" (click)="
                                          editKeyPerson(item,i)
                                        "><i class="fas fa-pen fa-1x cH-blue"></i>
                                      </a>
                                      <a href="javascript:void(0)" (click)="
                                          deleteKeyPerson(i)
                                        ">
                                        <i aria-hidden="true" class="fa fa-trash fa-1x cH-blue"></i>
                                      </a>
                                    </div>
                                  </td>
                                </tr>
                              </tbody>
                            </table>
                          </div>
                        </div>
                      </div>
                      <!-- <div class="form-row">
                        <div class="card-header">
                          Contact Number
                        </div>
                        <div class="form-group col-md-12 pl-0 pr-0">
                          <div class="card p-2" style="width: 100%;">
                            <h5 class="summery_text">
                              Mobile No -
                              <span>
                                <a href="javascript:void(0)" (click)="addMobileNo('personalMobileNoList')">Add Mobile
                                  No</a>
                              </span>
                            </h5>
                            <table class="table editable_tbl" style="width: 100%">
                              <tbody>
                                <tr class="default_row" *ngFor="
                                    let item of model?.personalMobileNoList;
                                    let i = index
                                  ">
                                  <td>{{ item?.displayLabel }}</td>
                                  <td class="profile-pic1">
                                    <div>
                                      <a href="javascript:void(0)" (click)="
                                          addMobileNo(
                                            'personalMobileNoList',
                                            item,
                                            i
                                          )
                                        "><i class="fas fa-pen fa-1x cH-blue"></i>
                                      </a>
                                      <a href="javascript:void(0)" (click)="
                                          deleteMobileNo(
                                            'personalMobileNoList',
                                            i
                                          )
                                        ">
                                        <i aria-hidden="true" class="fa fa-trash fa-1x cH-blue"></i>
                                      </a>
                                    </div>
                                  </td>
                                </tr>
                              </tbody>
                            </table>
                          </div>
                        </div>
                      </div>
                      <div class="form-row">
                        <div class="card-header">
                          Email Id
                        </div>
                        <div class="form-group col-md-12 pl-0 pr-0">
                          <div class="card p-2" style="width: 100%;">
                            <h5 class="summery_text">
                              Email -
                              <span>
                                <a href="javascript:void(0)" (click)="addEmail('personalEmailList')">Add Email</a>
                              </span>
                            </h5>
                            <table *ngIf="model?.personalEmailList?.length > 0" class="table editable_tbl"
                              style="width: 100%">
                              <thead>
                                <th>Email Type</th>
                                <th>Email Id</th>
                                <th>#</th>
                              </thead>
                              <tbody>
                                <tr class="default_row" *ngFor="
                                    let item of model?.personalEmailList;
                                    let i = index
                                  ">
                                  <td>{{ item?.emailTypeName }}</td>
                                  <td>{{ item?.email }}</td>
                                  <td class="profile-pic1">
                                    <div>
                                      <a href="javascript:void(0)" (click)="
                                          addEmail('personalEmailList', item, i)
                                        "><i class="fas fa-pen fa-1x cH-blue"></i>
                                      </a>
                                      <a href="javascript:void(0)" (click)="
                                          deleteEmail('personalEmailList', i)
                                        ">
                                        <i aria-hidden="true" class="fa fa-trash fa-1x cH-blue"></i>
                                      </a>
                                    </div>
                                  </td>
                                </tr>
                              </tbody>
                            </table>
                          </div>
                        </div>
                      </div> -->
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer" *ngIf="!formtype">
          <button type="submit" class="btn btn-primary waves-effect">
            Save
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<ng-container #addCommonMasterContainerRef></ng-container>
<ng-container #addMobileNoContainerRef></ng-container>
<ng-container #addEmailContainerRef></ng-container>
<ng-container #addAddressContainerRef></ng-container>
