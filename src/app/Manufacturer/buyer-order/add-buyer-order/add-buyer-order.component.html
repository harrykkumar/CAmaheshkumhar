<div
  class="modal fade"
  id="buyer_order_form"
  tabindex="-1"
  role="dialog"
  aria-labelledby="exampleModalLabel"
  aria-hidden="true"
>
  <div
    class="modal-dialog large_form modal-full-height modal-top"
    role="document"
  >
    <div class="modal-content bgcH-grey-100">
      <!--Header-->
      <form
        #buyerOrderForm="ngForm"
        novalidate
        (ngSubmit)="
          buyerOrderForm.form.valid && validateBuyerOrderForm() && submitForm()
        "
      >
        <div class="modal-header primary-bg">
          <div class="container-fluid">
            <div class="row">
              <div class="col-md-3 left_side_head">
                <p class="heading_lead">
                  <i class="fas fa-chart-line" aria-hidden="true"></i>New Buyer
                  Order
                </p>
              </div>
              <div class="col-md-9">
                <div class="btn_header">
                  <button type="submit" class="btn btn-default waves-effect">
                    Save
                  </button>
                  <!-- <a href="#" class="btn btn-info waves-effect">Save and New</a> -->
                  <button
                    type="button"
                    class="close"
                    data-dismiss="modal"
                    aria-label="Close"
                    (click)="resetBuyerOrderForm()"
                  >
                    <span aria-hidden="true" class="white-text">Ã—</span>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!--Body-->
        <div class="modal-body">
          <div class="form-row ">
            <div class="col-lg-8">
              <div class="card p-2">
                <div class="form-row ">
                  <div class="form-group col-md-4 col-lg-6 ">
                    <label
                      >Buyer Name <span class="compulsory_field">*</span></label
                    >
                    <select2
                      [data]="listItem?.buyerNameList"
                      class="control_select"
                      (valueChanged)="onDropDownChange($event, 'buyerNameId')"
                      autocomplete="true"
                      [value]="model?.buyerNameValue"
                      [ngClass]="{
                        errorSelecto:
                        buyerOrderForm?.submitted && !model?.buyerNameId
                      }"
                    >
                    </select2>
                  </div>
                  <div class="form-group col-md-4 col-lg-3 ">
                    <label>Date <span class="compulsory_field">*</span></label>
                    <div class="timepicker-input input-icon form-group">
                      <datepicker-popup
                        [toSetDate]="model?.OnDate"
                        [setMinDate]="''"
                        [setMaxDate]="''"
                        (dateInFormat)="model.OnDate = $event"
                      ></datepicker-popup>
                    </div>
                  </div>
                  <div class="form-group col-md-4 col-lg-3 ">
                    <label
                      >Order Type <span class="compulsory_field">*</span></label
                    >
                    <div class="input-group adw_select">
                      <div class="input-group adw_select">
                        <select2
                          [data]="listItem?.orderTypeList"
                          class="control_select"
                          (valueChanged)="
                            onDropDownChange($event, 'orderTypeId')
                          "
                          autocomplete="true"
                          [value]="model?.orderTypeValue"
                          [ngClass]="{
                            errorSelecto:
                            buyerOrderForm?.submitted && !model?.orderTypeId
                          }"
                        >
                        </select2>
                      </div>
                    </div>
                  </div>
                  <div class="form-group col-md-4 col-lg-3 ">
                    <label>Season<span class="compulsory_field">*</span></label>
                    <div class="input-group adw_select">
                      <div class="input-group adw_select">
                        <select2
                          [data]="listItem?.seasonList"
                          class="control_select"
                          (valueChanged)="onDropDownChange($event, 'seasonId')"
                          autocomplete="true"
                          [value]="model?.seasonValue"
                          [ngClass]="{
                            errorSelecto:
                            buyerOrderForm?.submitted && !model?.seasonId
                          }"
                        >
                        </select2>
                      </div>
                    </div>
                  </div>
                  <div class="form-group col-md-4 col-lg-3 ">
                    <label>Gender<span class="compulsory_field">*</span></label>
                    <div class="input-group adw_select">
                      <div class="input-group adw_select">
                        <select2
                          [data]="listItem?.genderList"
                          class="control_select"
                          (valueChanged)="onDropDownChange($event, 'genderId')"
                          autocomplete="true"
                          [value]="model?.genderValue"
                          [ngClass]="{
                            errorSelecto:
                            buyerOrderForm?.submitted && !model?.genderId
                          }"
                        >
                        </select2>
                      </div>
                    </div>
                  </div>
                  <div class="form-group col-md-4 col-lg-3 ">
                    <label
                      >Style No. <span class="compulsory_field">*</span></label
                    >
                    <div class="input-group adw_select">
                      <div class="input-group adw_select">
                        <select2
                          [data]="listItem?.styleNumberList"
                          class="control_select"
                          (valueChanged)="
                            onDropDownChange($event, 'styleNumberId')
                          "
                          autocomplete="true"
                          [value]="model?.styleNumberValue"
                          [ngClass]="{
                            errorSelecto:
                            buyerOrderForm?.submitted && !model?.styleNumberId
                          }"
                        >
                        </select2>
                      </div>
                    </div>
                  </div>
                  <div class="form-group col-md-2 col-lg-2 ">
                    <label>Order/PO No. </label>
                    <input
                      name="order_Po_No"
                      #orderPoRefModal="ngModel"
                      type="text"
                      class="form-control"
                      placeholder="Enter Order/PO No."
                      [(ngModel)]="model.orderPoNumber"
                    />
                  </div>
                  <div class="form-group col-md-2 col-lg-2 ">
                    <label
                      >Order Date <span class="compulsory_field">*</span></label
                    >
                    <div class="timepicker-input input-icon form-group">
                      <datepicker-popup
                        [toSetDate]="model?.orderDate"
                        [setMinDate]="''"
                        [setMaxDate]="''"
                        (dateInFormat)="model.orderDate = $event"
                      ></datepicker-popup>
                    </div>
                  </div>
                  <div class="form-group col-md-2 col-lg-2  ">
                    <label
                      >Ship Date <span class="compulsory_field">*</span></label
                    >
                    <div class="timepicker-input input-icon form-group">
                      <datepicker-popup
                        [toSetDate]="model?.shipDate"
                        [setMinDate]="''"
                        [setMaxDate]="''"
                        (dateInFormat)="model.shipDate = $event"
                      ></datepicker-popup>
                    </div>
                  </div>
                  <div class="form-group col-md-2 col-lg-2  ">
                    <label
                      >Ex Fact Date
                      <span class="compulsory_field">*</span></label
                    >
                    <div class="timepicker-input input-icon form-group">
                      <datepicker-popup
                        [toSetDate]="model?.exFactDate"
                        [setMinDate]="''"
                        [setMaxDate]="''"
                        (dateInFormat)="model.exFactDate = $event"
                      ></datepicker-popup>
                    </div>
                  </div>
                  <!-- <div class="form-group col-md-2 col-lg-2  ">
                                      <label>Ship Ex. Date1 <span class="compulsory_field">*</span></label>
                                      <div class="timepicker-input input-icon form-group">
                                        <datepicker-popup
                                          [toSetDate]="model?.shipExDate1"
                                          [setMinDate]="''"
                                          [setMaxDate]="''"
                                          (dateInFormat)="model.shipExDate1 = $event"
                                        ></datepicker-popup>
                                      </div>
                                  </div>
                                  <div class="form-group col-md-2 col-lg-2  ">
                                      <label>Ship Ex. Date2 <span class="compulsory_field">*</span></label>
                                      <div class="timepicker-input input-icon form-group">
                                        <datepicker-popup
                                          [toSetDate]="model?.shipExDate2"
                                          [setMinDate]="''"
                                          [setMaxDate]="''"
                                          (dateInFormat)="model.shipExDate2 = $event"
                                        ></datepicker-popup>
                                      </div>
                                  </div> -->
                </div>
              </div>
            </div>
            <div class="col-lg-4">
              <div class="card p-2">
                <div class="form-row ">
                  <div class="form-group col-md-6">
                    <label>Ship. Mode</label>
                    <select2
                      [data]="listItem?.shipModeList"
                      class="control_select"
                      (valueChanged)="onDropDownChange($event, 'shipModeId')"
                      autocomplete="true"
                      [value]="model?.shipModeValue"
                      [ngClass]="{
                        errorSelecto:
                        buyerOrderForm?.submitted && !model?.shipModeId
                      }"
                    >
                    </select2>
                  </div>
                  <!-- <div class="form-group col-md-6">
                                        <label>Ship. Terms</label>
                                        <select2
                                        [data]="listItem?.shipMentTermList"
                                        class="control_select"
                                        (valueChanged)="onDropDownChange($event, 'shipTermId')"
                                        autocomplete="true"
                                        [value]="model?.shipMentTermValue">
                                      </select2>
                                    </div> -->
                  <div class="form-group col-md-6">
                    <label>Payment Mode</label>
                    <select2
                      [data]="listItem?.payMentModeList"
                      class="control_select"
                      (valueChanged)="onDropDownChange($event, 'paymentModeId')"
                      autocomplete="true"
                      [value]="model?.payMentModeValue"
                      [ngClass]="{
                        errorSelecto:
                        buyerOrderForm?.submitted && !model?.paymentModeId
                      }"
                    >
                    </select2>
                  </div>
                  <!-- <div class="form-group col-md-6">
                                        <label>Payment Terms</label>
                                        <select2
                                        [data]="listItem?.paymentTermList"
                                        class="control_select"
                                        (valueChanged)="onDropDownChange($event, 'paymentTermId')"
                                        autocomplete="true"
                                        [value]="model?.payMentTermValue">
                                      </select2>
                                    </div> -->
                  <div class="form-group col-md-6">
                    <label>Currency</label>
                    <select2
                      [data]="listItem?.currencyList"
                      class="control_select"
                      (valueChanged)="onDropDownChange($event, 'currencyId')"
                      autocomplete="true"
                      [value]="model?.currencyValue"
                      [ngClass]="{
                        errorSelecto:
                        buyerOrderForm?.submitted && !model?.currencyId
                      }"
                    >
                    </select2>
                  </div>
                  <!-- <div class="form-group col-md-6">
                                      <label>Type</label>
                                      <select2
                                      [data]="listItem?.typeList"
                                      class="control_select"
                                      (valueChanged)="onTypeChange($event)"
                                      autocomplete="true"
                                      [value]="model?.typeValue">
                                    </select2>
                                  </div>
                                  <div class="form-group col-md-6">
                                      <label>Conv. Rate</label>
                                      <select2
                                      [data]="listItem?.convertRateList"
                                      class="control_select"
                                      (valueChanged)="onConvertRateChange($event)"
                                      autocomplete="true"
                                      [value]="model?.convertRateValue">
                                    </select2>
                                  </div> -->
                  <div class="form-group col-md-6 pt-4">
                    <div class="form-row">
                      <div class="custom-control custom-checkbox my-1 mr-sm-2">
                        <input
                          type="checkbox"
                          name="completedCheckBox"
                          [(ngModel)]="model.completed"
                          class="custom-control-input"
                          id="completed"
                        />
                        <label class="custom-control-label" for="completed"
                          >Completed</label
                        >
                      </div>
                      <div class="custom-control custom-checkbox my-1 mr-sm-2">
                        <input
                          type="checkbox"
                          name="cancelCheckBox"
                          [(ngModel)]="model.cancelled"
                          class="custom-control-input"
                          id="cancelled"
                        />
                        <label class="custom-control-label" for="cancelled"
                          >Cancelled</label
                        >
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <form
            #itemForm="ngForm"
            novalidate
            (ngSubmit)="
              itemForm.form.valid &&
                validateItemAddForm() &&
                openAttributeCombinationModal()
            "
          >
            <div class="form-row mt-2">
              <div class="col-lg-10">
                <div class="card p-2">
                  <div class="form-row ">
                    <div class="form-group col-md-2 col-lg-2">
                      <label
                        >Item Name
                        <span class="compulsory_field">*</span></label
                      >
                      <div class="input-group adw_select">
                        <div class="input-group adw_select">
                          <select2
                            [data]="listItem?.itemList"
                            class="control_select"
                            (valueChanged)="onDropDownChange($event, 'itemId')"
                            autocomplete="true"
                            [value]="model?.itemValue"
                            [ngClass]="{
                              errorSelecto:
                                itemForm?.submitted && !model?.itemId
                            }"
                          >
                          </select2>
                        </div>
                      </div>
                    </div>
                    <div class="form-group col-md-2 col-lg-2 ">
                      <label>Order Qty</label>
                      <input
                        type="number"
                        #orderQtyModal="ngModel"
                        class="form-control"
                        name="orderQuantity"
                        (change)="generateProductionQty()"
                        [(ngModel)]="model.orderQuantity"
                        [ngClass]="{
                          'is-invalid':
                            itemForm?.submitted && orderQtyModal.invalid
                        }"
                        required
                      />
                    </div>
                    <div class="form-group col-md-2 col-lg-2 ">
                      <label>Add %</label>
                      <input
                        type="number"
                        #addPercentageModal="ngModel"
                        class="form-control"
                        name="add"
                        (change)="generateProductionQty()"
                        [(ngModel)]="model.addPercentage"
                        [ngClass]="{
                          'is-invalid':
                            itemForm?.submitted && addPercentageModal.invalid
                        }"
                        required
                      />
                    </div>
                    <div class="form-group col-md-2 col-lg-2 ">
                      <label>Production Qty</label>
                      <input
                        type="number"
                        #productionQtyModal="ngModel"
                        class="form-control"
                        name="productionQty"
                        [(ngModel)]="model.productionQty"
                        [ngClass]="{
                          'is-invalid':
                            itemForm?.submitted && productionQtyModal.invalid
                        }"
                        required
                      />
                    </div>
                    <div class="form-group col-md-3 col-lg-3">
                      <label>Remark</label>
                      <textarea
                        class="form-control"
                        name="remark"
                        [(ngModel)]="model.remark"
                      ></textarea>
                    </div>
                    <div class="form-group col-md-3 col-lg-3">
                      <label
                        >Packing Type
                        <span class="compulsory_field">*</span></label
                      >
                      <div class="input-group adw_select">
                        <div class="input-group adw_select">
                          <select2
                            [data]="listItem?.packagingTypeList"
                            class="control_select"
                            (valueChanged)="
                              onDropDownChange($event, 'packingTypeId')
                            "
                            autocomplete="true"
                            [value]="model?.packageTypeValue"
                            [ngClass]="{
                              errorSelecto:
                                itemForm?.submitted && !model?.packingTypeId
                            }"
                          >
                          </select2>
                        </div>
                      </div>
                    </div>
                    <!-- <div class="form-group col-md-3 col-lg-3">
                                      <label>Item Set Type <span class="compulsory_field">*</span></label>
                                      <div class="input-group adw_select">
                                            <div class="input-group adw_select">
                                              <select2
                                                [data]="listItem?.itemSetTypeList"
                                                class="control_select"
                                                (valueChanged)="itemSetTypeChange($event)"
                                                autocomplete="true"
                                                [value]="model?.itemSetTypeValue">
                                              </select2>
                                            </div>
                                          </div>
                                  </div> -->
                    <div class="form-group col-md-1 mt-3">
                      <button
                        type="submit"
                        class="btn btn-primary waves-effect"
                        aria-expanded="false"
                      >
                        Add
                      </button>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-lg-2">
                <div class="card">
                  <div class="card-body">
                    <!-- <div class="card mt-2"> -->
                      <div class="p-3">
                        <a
                        (click)="openImageModal()"
                        class="custom-file-upload"
                        id="imageUploadId"
                        ><i class="fas fa-upload"></i> Image Upload
                      </a> </div>
                        <div>
                          <div *ngIf="ImageFiles && ImageFiles.length > 0">
                            <div
                              class="mB-5"
                              *ngFor="let image of ImageFiles; let i = index"
                            >
                              <div>
                                <strong class="mr-auto">{{
                                  image.Name
                                }}</strong>
                                <button
                                  type="button"
                                  class="image-cross-icon ml-2 mb-1 close"
                                  (click)="removeImage(i)"
                                >
                                  &times;
                                </button>
                              </div>
                            </div>
                          </div>
                        </div>
                        <!-- <div >
                          <div *ngIf="ImageFiles && ImageFiles.length > 0">
                            <img width="40%"
                              id="center-img"
                              [src]="ImageFiles[0].BaseString"
                              (click)="openImageModal()"
                            />
                          </div>
                        </div> -->
                    <!-- </div> -->
                  </div>
                </div>
              </div>
            </div>
          </form>

          <div class="form-row">
            <div class="col-md-12 card  p-2">
              <div class="table-responsive">
                <table class="table table editable_tbl">
                  <thead>
                    <tr class="default_row">
                      <th style="width: 10px;">#</th>
                      <th>Size</th>
                      <th>Attribute Combination</th>
                      <th>Order Qty</th>
                      <th>Unit</th>
                      <th>Add %</th>
                      <th>Prod. Qty</th>
                      <th>Rate</th>
                      <!-- <th>PCS</th> -->
                      <th>Amount</th>
                      <!-- <th>Cancel Qty</th> -->
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let item of orderList" class="selected_row active">
                      <td>
                        <div class="action_btn">
                          <a>
                            <i aria-hidden="true" class="fa fa-trash fa-1x"></i>
                          </a>
                        </div>
                      </td>
                      <td>{{ item?.sizeName }}</td>
                      <td>{{ item?.attributeValueName }}</td>
                      <td>{{ item?.orderQuantity }}</td>
                      <td>{{item?.unitName}}</td>
                      <td>{{item?.addPercentage}}</td>
                      <td>{{item?.productionQty}}</td>
                      <td>{{item?.rate}}</td>
                      <td>{{item?.amount}}</td>
                      <!-- <td>1500.000</td> -->
                      <!-- <td>0.000</td> -->
                    </tr>
                    <tr>
                      <td></td>
                      <td></td>
                      <td></td>
                      <td>{{model?.totalOrderedQty}}</td>
                      <td></td>
                      <td></td>
                      <td>{{model?.totalProductionQty}}</td>
                      <td></td>
                      <td></td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>

<app-attribute-combination
  #attribute_combine_form
  (triggerCloseModal)="onCombinationModalClose($event)"
></app-attribute-combination>
