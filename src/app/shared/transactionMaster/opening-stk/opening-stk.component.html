<main class="main-content bgc-grey">
  <div id="mainContent">
    <div class="page-header p-0">
      <div class="container-fluid">
        <div class="row">
          <div class="col-md-4 left_side_head">
            <p class="heading_lead c-grey-900 mb-0">
              <i class="far fa-building"></i>Opening Stock
            </p>
          </div>
          <div class="col-md-8 right_saerch_side p-0">
            <div class="btn_header">
              <a><img src="assets/img/printer.png" /> </a>
              <a><img src="assets/img/pdf.png"/></a>
              <a><img src="assets/img/excel.png"/></a>
              <button
                type="button"
                class="btn btn-primary waves-effect waves-light"
                (click)="triggerModelOpen()"
              >
                Add Opening Stock
              </button>
              <a
                (click)="toggleSearch()"
                class="btn btn-info"
                data-toggle="collapse"
                ><i class="fas fa-search"></i>Search</a
              >
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-md-12">
        <div class="bgc-white bdrs-3 pb-3 mB-20">
          <div class="table-responsive table_height">
            <table class="table cat-table table-hover">
              <thead>
                <tr class="default_row">
                  <th>SNo.</th>
                  <th>Item Name</th>
                  <th>Unit Name</th>
                  <th
                    class="dynamic_fix"
                    *ngFor="let column of masterData?.Attributes"
                  >
                    {{ column?.Name }}
                  </th>
                  <th>BarCode</th>
                  <th>Client BarCode</th>
                  <th>Opn. Stk Qty</th>
                  <th>Opn. Stk Value</th>
                  <th>Rate</th>
                  <th>SaleRate</th>
                  <th>NrvRate</th>
                  <th>Mrp</th>
                  <th>OurPrice</th>
                </tr>
              </thead>

              <tbody *ngIf="isProgress" style="height:100px;">
                <img
                  src="assets/img/spinner-blue-circle.gif"
                  alt="loading screen"
                  style="width: 20px;height: 20px;position: absolute;left: 46%;top:46%;"
                />
              </tbody>

              <tbody>
                <tr
                  class="default_row"
                  *ngFor="let item of itemWithAttributeList; let i = index"
                >
                  <td>{{ i + 1 }}</td>
                  <td>{{ item.ItemName }}</td>
                  <td>{{ item.UnitName }}</td>
                  <td *ngFor="let name of item?.AttributeNamestr">
                    {{ name }}
                  </td>
                  <td>
                    <input
                      type="text"
                      class="form-control"
                      name="barCode-{{ i }}"
                      [(ngModel)]="item.Barcode"
                      [disabled]="!item.Checked"
                    />
                  </td>
                  <td>
                    <input
                      type="text"
                      class="form-control"
                      name="client-barCode-{{ i }}"
                      [(ngModel)]="item.ClientBarCode"
                      [disabled]="!item.Checked"
                    />
                  </td>
                  <td>
                    <input
                      type="text"
                      class="form-control"
                      name="opening-stock-qty-{{ i }}"
                      (input)="onOpeningStockChange(i)"
                      [(ngModel)]="item.Qty"
                      [disabled]="!item.Checked"
                      [ngClass]="{
                        'is-invalid':
                          item.Checked && !item.Qty && item.isInvalid
                      }"
                    />
                  </td>
                  <td>
                    <input
                      type="text"
                      class="form-control"
                      name="opening-stock-value-{{ i }}"
                      (input)="onOpeningStockValueChange(i)"
                      [(ngModel)]="item.QtyValue"
                      [disabled]="!item.Checked"
                      [ngClass]="{
                        'is-invalid':
                          item.Checked && !item.QtyValue && item.isInvalid
                      }"
                    />
                  </td>
                  <td>
                    <input
                      type="text"
                      class="form-control"
                      name="purchase-rate-{{ i }}"
                      (input)="onPurchaseRateChange(i)"
                      [(ngModel)]="item.RatePurchase"
                      [disabled]="!item.Checked"
                      [ngClass]="{
                        'is-invalid':
                          item.Checked && !item.RatePurchase && item.isInvalid
                      }"
                    />
                  </td>
                  <td>
                    <input
                      type="text"
                      class="form-control"
                      name="sale-rate-{{ i }}"
                      [(ngModel)]="item.RateSale"
                      [disabled]="!item.Checked"
                    />
                  </td>
                  <td>
                    <input
                      type="text"
                      class="form-control"
                      name="nrv-rate-{{ i }}"
                      [(ngModel)]="item.RateNrv"
                      [disabled]="!item.Checked"
                    />
                  </td>
                  <td>
                    <input
                      type="text"
                      class="form-control"
                      name="mrp-rate-{{ i }}"
                      [(ngModel)]="item.RateMrp"
                      [disabled]="!item.Checked"
                    />
                  </td>

                  <td>
                    <input
                      type="text"
                      class="form-control"
                      name="oar-price-{{ i }}"
                      [(ngModel)]="item.RateOur"
                      [disabled]="!item.Checked"
                    />
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        <!-- <app-pagination #paging_comp (lastValueEmitter)="lastItemIndex = $event;"
            (pageNoEmitter)="p = $event;getItemMasterDetail();"
            (pageSizeEmitter)="itemsPerPage = $event;getItemMasterDetail();" ></app-pagination> -->
      </div>
    </div>
  </div>
</main>
<!-- <app-item-import></app-item-import> -->

<div
  class="modal fade"
  id="opening-stk"
  role="dialog"
  aria-labelledby="exampleModalLabel"
  aria-hidden="true"
  data-backdrop="static"
  data-keyboard="false"
>
  <div
    class="modal-dialog large_form modal-full-height modal-top"
    role="document"
  >
    <div class="modal-content bgcH-grey-100">
      <div class="modal-header primary-bg">
        <div class="container-fluid">
          <div class="row">
            <div class="col-md-3 left_side_head">
              <p class="heading_lead">
                <i class="fas fa-shopping-cart" aria-hidden="true"></i>
                Opening Stock
              </p>
            </div>
            <div class="col-md-5">
              <form>
                <div id="custom-search-input" class="btn_header1">
                  <div class="input-group col-md-12">
                    <input
                      type="text"
                      id="searchInput"
                      class="form-control input-lg"
                      placeholder="Search"
                      (input)="searchFilter()"
                    />
                    <span class="input-group-btn">
                      <a>
                        <i class="fas fa-search"></i>
                      </a>
                    </span>
                  </div>
                </div>
              </form>
            </div>
            <div class="col-md-4">
              <div class="btn_header">
                <a
                  class="btn btn-default waves-effect"
                  (click)="
                    validateForm() && postFormData(itemWithAttributeList)
                  "
                  data-dismiss="modal"
                >
                  Save
                </a>
                <button
                  type="button"
                  (click)="cancelForm()"
                  class="close"
                  data-dismiss="modal"
                  aria-label="Close"
                >
                  <span aria-hidden="true" class="white-text">Ã—</span>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-body">
         
        <form>
          <div class="bgc-white bdrs-3 pb-3 mB-20">
            <div *ngIf="isAttribute" class="form-group col-md-12">
              <label>Attribute Combination</label>
              <div class="input-group adw_select">
                <div class="input-group adw_select">
                  <select2
                    [data]="attributeCombinationList"
                    [options]="options"
                    [value]="selectedAttributeCombination"
                    (valueChanged)="onAttributeCombinationChange($event)"
                    class="control_select"
                    autocomplete="true"
                  >
                  </select2>
                </div>
              </div>
            </div>
            <!-- <div>
              <span ><img [hidden]="!isLoading"
                src="assets/img/spinner-blue-circle.gif"
                style="width: 50px;height: 50px;position: absolute;left: 46%;top: 80%;"
              /></span>
            </div> -->
            <div class="table-responsive table-item-attribute">
              <table
                class="table cat-table table-hover"
                id="item-attribute-table"
              >
                <thead>
                  <tr class="default_row">
                    <th>SNo.</th>
                    <th>
                      <div class="custom-control custom-checkbox">
                        <input
                          name="checkAll"
                          [(ngModel)]="allChecked"
                          (change)="checkAllItem($event)"
                          type="checkbox"
                          class="custom-control-input"
                          id="CheckAllItemAttribute"
                        />
                        <label
                          class="custom-control-label"
                          for="CheckAllItemAttribute"
                        ></label>
                      </div>
                    </th>
                    <th>Item Name</th>
                    <th>Unit Name</th>
                    <th
                      class="dynamic_fix"
                      *ngFor="let column of masterData?.Attributes"
                    >
                      {{ column?.Name }}
                    </th>
                    <th>BarCode</th>
                    <th>Client BarCode</th>
                    <th>Opn. Stk Qty</th>
                    <th>Opn. Stk Value</th>
                    <th>Rate</th>
                    <th>SaleRate</th>
                    <th>NrvRate</th>
                    <th>Mrp</th>
                    <th>OurPrice</th>
                  </tr>
                </thead>
                <tbody>
                  <tr
                    class="default_row"
                    *ngFor="let item of itemWithAttributeList; let i = index"
                  >
                    <td>{{ i + 1 }}</td>
                    <td>
                      <div class="custom-control custom-checkbox">
                        <input
                          name="{{ i }}-checkItem"
                          [(ngModel)]="item.Checked"
                          type="checkbox"
                          class="custom-control-input"
                          id="{{ i }}-itemAttribute"
                        />
                        <label
                          class="custom-control-label"
                          for="{{ i }}-itemAttribute"
                        ></label>
                      </div>
                    </td>
                    <td>{{ item.ItemName }}</td>
                    <td>{{ item.UnitName }}</td>
                    <td *ngFor="let name of item?.AttributeNamestr">
                      {{ name }}
                    </td>
                    <td>
                      <input
                        type="text"
                        class="form-control"
                        name="barCode-{{ i }}"
                        [(ngModel)]="item.Barcode"
                        [disabled]="!item.Checked"
                      />
                    </td>
                    <td>
                      <input
                        type="text"
                        class="form-control"
                        name="client-barCode-{{ i }}"
                        [(ngModel)]="item.ClientBarCode"
                        [disabled]="!item.Checked"
                      />
                    </td>
                    <td>
                      <input
                        type="text"
                        class="form-control"
                        name="opening-stock-qty-{{ i }}"
                        (input)="onOpeningStockChange(i)"
                        [(ngModel)]="item.Qty"
                        [disabled]="!item.Checked"
                        [ngClass]="{
                          'is-invalid':
                            item.Checked && !item.Qty && item.isInvalid
                        }"
                      />
                    </td>
                    <td>
                      <input
                        type="text"
                        class="form-control"
                        name="opening-stock-value-{{ i }}"
                        (input)="onOpeningStockValueChange(i)"
                        [(ngModel)]="item.QtyValue"
                        [disabled]="!item.Checked"
                        [ngClass]="{
                          'is-invalid':
                            item.Checked && !item.QtyValue && item.isInvalid
                        }"
                      />
                    </td>
                    <td>
                      <input
                        type="text"
                        class="form-control"
                        name="purchase-rate-{{ i }}"
                        (input)="onPurchaseRateChange(i)"
                        [(ngModel)]="item.RatePurchase"
                        [disabled]="!item.Checked"
                        [ngClass]="{
                          'is-invalid':
                            item.Checked && !item.RatePurchase && item.isInvalid
                        }"
                      />
                    </td>
                    <td>
                      <input
                        type="text"
                        class="form-control"
                        name="sale-rate-{{ i }}"
                        [(ngModel)]="item.RateSale"
                        [disabled]="!item.Checked"
                      />
                    </td>
                    <td>
                      <input
                        type="text"
                        class="form-control"
                        name="nrv-rate-{{ i }}"
                        [(ngModel)]="item.RateNrv"
                        [disabled]="!item.Checked"
                      />
                    </td>
                    <td>
                      <input
                        type="text"
                        class="form-control"
                        name="mrp-rate-{{ i }}"
                        [(ngModel)]="item.RateMrp"
                        [disabled]="!item.Checked"
                      />
                    </td>

                    <td>
                      <input
                        type="text"
                        class="form-control"
                        name="oar-price-{{ i }}"
                        [(ngModel)]="item.RateOur"
                        [disabled]="!item.Checked"
                      />
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
